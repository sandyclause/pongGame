<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bounce game</title>
    <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
    <header>
        <div class="wrapper">
            <h1>Simple Pong Game</h1>
        </div>
    </header>
    <main>
        <div class="description">
            <p>Hi, this is my simple pong game. The goal of the game is to not let the balls fall through the bottom of the screen using the paddle.</p>

            <button id="play">Play</button>

        </div>
        <div class="game">
            <!-- <div class="ball"></div> -->
            <div class="result"></div>
            <div class="paddle"></div>

        </div>
    </main>
    <footer>
        <div class="wrapper">
            <div class="contactShare">
                <p>by: sandy tian</p>

            </div>
        </div>
    </footer>
    





<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>


<script>
    // deleting
    // animating
    // add scores
    // add twitter
    // data visual

    $(function () {
        $('#play').click(function(){
            
            //start game
            init();

            //hide button
            $('.description').css('display', 'none');


        });

        function init(){
            //add balls
            let randomTimer = (Math.floor(Math.random()*3) * 1000);
            setInterval(function(){
                addBall();
                requestAnimationFrame(repeatOften);
                
            }, 3000);


            //display paddle and hide cursor
            $('.paddle').css('display', 'block');
            $('body').css('cursor', 'none');
        };



//loop through balls to add unique classname
        let lastBall;

        function addBall() {
             
            $('.game').append(`<div class="ball"></div>`);
            $('.ball').each(function (index, ball) {
                // $(ball).addClass('ball' + index);
                $(ball).attr('class', 'ball' + ' ' +'ball' + index);
                lastBall = index;


            });

            //randomly position ball
            randomStart();
        };



//random ball starting position
        function randomStart() {
            let x = Math.floor(Math.random() * 500);
            $('.ball' + lastBall).css('left', x + 'px');

        };

//collision function
        function collisionCheck(){
            let n = $('.ball').length;
            // console.log('number of balls ' + n);
            for(let i = 0; i < n; i++){
                // console.log('inside for loop' + i);
                let dynamicBall = ('.ball' + i);
                //get the cords of the ball and paddle
                setCords(dynamicBall);

                var ball = $(dynamicBall).data('coordinates');
                var paddle = $('.paddle').data('coordinates');

                if(isCollide(ball, paddle)){

                    //set moving down to false
                    $(dynamicBall).data('moveDown', false);
                    $(dynamicBall).data('moveUp', true);
                   
                    moveBack(dynamicBall);
                } 
                else{
                    
                    //set moving up to false
                    $(dynamicBall).data('moveUp', false);
                    $(dynamicBall).data('moveDown', true);

                    move(ball.y, dynamicBall);
                }


                
            }

        };

//check if ball has passed boundaries. if so, delete ball
        function deleteBall(item, itemSelf){
            console.log('removed ' + itemSelf);
            // if(item > 500){
            //     // $(itemSelf).remove();
            //     console.log('removed '+itemSelf);
            // }
        }


//constant check collision status
        function repeatOften(){
            collisionCheck();
            requestAnimationFrame(repeatOften);
        };

//setting the x and y values
        function setCords(ball){
            // console.log($(ball));

            $(ball).data('coordinates', {
                x: $(ball).offset().left,
                y: $(ball).offset().top,
                height: $(ball).outerHeight(),
                width: $(ball).outerWidth()
            });

            //sets moving down intial value to true
            $(ball).data('moveDown', true);
            $(ball).data('moveUp', false);
   
            $('.paddle').data('coordinates', {
                x: $('.paddle').offset().left,
                y: $('.paddle').offset().top,
                height: $('.paddle').outerHeight(),
                width: $('.paddle').outerWidth()
            });        
        };

//set interval
//request animation

        function move(ball, dynamicBall){
      
            if(ball.y < 500){
                deleteBall(ball.y, dynamicBall);

            } else{
                $(dynamicBall).css('top', '+=1');
            }
            
            //move the ball only when moving down === true
            // if($(ball).data('moveDown') === true){
            //     $(ball).css('top', '+=1');
            //     // console.log('down move');       
            // } else{
            //     console.log('down not move');
            // }
        };

        function moveBack(ball) {
            // const onTop = parseInt($(ball).css('top'),10);
            // if(onTop >= 0){
            //     $(ball).animate({ top: '0px' }, 5000);   
            // }

            if ($(ball).data('moveUp') === true){
                $(ball).animate({ top: '0px' }, 5000);
                // console.log('up move');
            }else{
                console.log('up not move')
            }
        };        

// collision function
        function isCollide(a, b) {
            return !(
                ((a.y + a.height) < (b.y)) ||
                (a.y > (b.y + b.height)) ||
                ((a.x + a.width) < b.x) ||
                (a.x > (b.x + b.width))
            );
        };

//mouse as paddle

        $(document).on('mousemove', function(e){
            $('.paddle').css('top', e.pageY);
            $('.paddle').css('left', e.pageX);
        });


//hide mouse
        

    });//end of doc ready


</script>    



    
<script>

    // https://stackoverflow.com/users/2051938/mixeroid

</script>
</body>
</html>